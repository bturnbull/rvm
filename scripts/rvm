#!/bin/bash

#
# rvm : Ruby Version Manager
# http://rvm.beginrescueend.com
# http://gitub.com/wayneeseguin/rvm
#

if [[ "root" = "$(whoami)" ]] ; then
  rvm_prefix_path="${rvm_prefix_path:-/usr/local/}"
else
  rvm_prefix_path="${rvm_prefix_path:-"$HOME/."}"
fi

if [[ "${rvm_prefix_path#${rvm_prefix_path%?}}" = '.' ]] || [[ "${rvm_prefix_path#${rvm_prefix_path%?}}" = '/' ]] ; then
  rvm_path="${rvm_prefix_path}rvm"
else
  rvm_path="${rvm_prefix_path}/rvm"
fi

source $rvm_path/scripts/color
source $rvm_path/scripts/utility
source $rvm_path/scripts/selector
source $rvm_path/scripts/ruby-installer # TODO: Script not function.
source $rvm_path/scripts/cli
source $rvm_path/scripts/gems

rvm_loaded_flag=1 ; export rvm_loaded_flag

rvm_version="$(cat "${rvm_path}/lib/VERSION.yml" | tail -n 3 | sed 's/^.*: //g' | tr "\n" '.' | sed 's/\.$//')" ; export rvm_version

alias rvm-restart="source \"${rvm_path}/scripts/rvm\""

if [[ -f "$rvm_path/default" ]] ; then source "$rvm_path/default" ; fi

# Ok now we determine if we were called or sourced... under assumption of course ;)
if [[ $# -gt 0 ]] ; then rvm "$*" ; fi

